

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Connection &mdash; k-ctds 2.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=9edc463e" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=20623aea"></script>
      <script src="_static/doctools.js?v=fd6eb6e6"></script>
      <script src="_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Cursor" href="cursor.html" />
    <link rel="prev" title="API Reference" href="api.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            k-ctds
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="example.html">Basic Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="execute.html">Executing SQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="callproc.html">Calling Stored Procedures</a></li>
<li class="toctree-l1"><a class="reference internal" href="results.html">Reading Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="transactions.html">Transactions</a></li>
<li class="toctree-l1"><a class="reference internal" href="bulk_insert.html">Bulk Insert</a></li>
<li class="toctree-l1"><a class="reference internal" href="pooling.html">Connection Pooling</a></li>
<li class="toctree-l1"><a class="reference internal" href="encryption.html">TLS/SSL Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="api.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Connection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#k_ctds.Connection"><code class="docutils literal notranslate"><span class="pre">Connection</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#k_ctds.Connection.__enter__"><code class="docutils literal notranslate"><span class="pre">Connection.__enter__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#k_ctds.Connection.__exit__"><code class="docutils literal notranslate"><span class="pre">Connection.__exit__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#k_ctds.Connection.__repr__"><code class="docutils literal notranslate"><span class="pre">Connection.__repr__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#k_ctds.Connection.autocommit"><code class="docutils literal notranslate"><span class="pre">Connection.autocommit</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#k_ctds.Connection.bulk_insert"><code class="docutils literal notranslate"><span class="pre">Connection.bulk_insert()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#k_ctds.Connection.close"><code class="docutils literal notranslate"><span class="pre">Connection.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#k_ctds.Connection.commit"><code class="docutils literal notranslate"><span class="pre">Connection.commit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#k_ctds.Connection.cursor"><code class="docutils literal notranslate"><span class="pre">Connection.cursor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#k_ctds.Connection.database"><code class="docutils literal notranslate"><span class="pre">Connection.database</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#k_ctds.Connection.messages"><code class="docutils literal notranslate"><span class="pre">Connection.messages</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#k_ctds.Connection.rollback"><code class="docutils literal notranslate"><span class="pre">Connection.rollback()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#k_ctds.Connection.spid"><code class="docutils literal notranslate"><span class="pre">Connection.spid</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#k_ctds.Connection.tds_version"><code class="docutils literal notranslate"><span class="pre">Connection.tds_version</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#k_ctds.Connection.timeout"><code class="docutils literal notranslate"><span class="pre">Connection.timeout</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#k_ctds.Connection.use"><code class="docutils literal notranslate"><span class="pre">Connection.use()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#string-representation">String Representation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cursor.html">Cursor</a></li>
<li class="toctree-l2"><a class="reference internal" href="ctds.html">ctds</a></li>
<li class="toctree-l2"><a class="reference internal" href="parameter.html">Parameter</a></li>
<li class="toctree-l2"><a class="reference internal" href="rowlist.html">RowList</a></li>
<li class="toctree-l2"><a class="reference internal" href="types.html">SQL Type Wrappers</a></li>
<li class="toctree-l2"><a class="reference internal" href="pool.html">k_ctds.pool</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="CHANGELOG.html">Change Log</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">k-ctds</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="api.html">API Reference</a></li>
      <li class="breadcrumb-item active">Connection</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/connection.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="connection">
<h1>Connection<a class="headerlink" href="#connection" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="k_ctds.Connection">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">k_ctds.</span></span><span class="sig-name descname"><span class="pre">Connection</span></span><a class="headerlink" href="#k_ctds.Connection" title="Link to this definition"></a></dt>
<dd><p>A connection to the database server.</p>
<p><span class="target" id="index-0"></span><a class="pep reference external" href="https://peps.python.org/pep-0249/#connection-objects"><strong>PEP 0249#connection-objects</strong></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="k_ctds.Connection.__enter__">
<span class="sig-name descname"><span class="pre">__enter__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#k_ctds.Connection.__enter__" title="Link to this definition"></a></dt>
<dd><p>Enter the connection’s runtime context. On exit, the connection is
closed automatically.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The connection object.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#k_ctds.Connection" title="k_ctds.Connection">k_ctds.Connection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="k_ctds.Connection.__exit__">
<span class="sig-name descname"><span class="pre">__exit__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exc_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exc_val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exc_tb</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_ctds.Connection.__exit__" title="Link to this definition"></a></dt>
<dd><p>Exit the connection’s runtime context, closing the connection.
If no error occurred, any pending transaction will be committed
prior to closing the connection. If an error occurred, the transaction
will be implicitly rolled back when the connection is closed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exc_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.14)"><em>type</em></a>) – The exception type, if an exception
is raised in the context, otherwise <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a>.</p></li>
<li><p><strong>exc_val</strong> (<a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.14)"><em>Exception</em></a>) – The exception value, if an exception
is raised in the context, otherwise <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a>.</p></li>
<li><p><strong>exc_tb</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><em>object</em></a>) – The exception traceback, if an exception
is raised in the context, otherwise <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="k_ctds.Connection.__repr__">
<span class="sig-name descname"><span class="pre">__repr__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#k_ctds.Connection.__repr__" title="Link to this definition"></a></dt>
<dd><p>Return repr(self).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="k_ctds.Connection.autocommit">
<span class="sig-name descname"><span class="pre">autocommit</span></span><a class="headerlink" href="#k_ctds.Connection.autocommit" title="Link to this definition"></a></dt>
<dd><p>Auto-commit transactions after <a class="reference internal" href="cursor.html#k_ctds.Cursor.execute" title="k_ctds.Cursor.execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">k_ctds.Cursor.execute()</span></code></a>,
<a class="reference internal" href="cursor.html#k_ctds.Cursor.executemany" title="k_ctds.Cursor.executemany"><code class="xref py py-meth docutils literal notranslate"><span class="pre">k_ctds.Cursor.executemany()</span></code></a>, and <a class="reference internal" href="cursor.html#k_ctds.Cursor.callproc" title="k_ctds.Cursor.callproc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">k_ctds.Cursor.callproc()</span></code></a>.
If <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">False</span></code></a>, operations must be committed explicitly using
<a class="reference internal" href="#k_ctds.Connection.commit" title="k_ctds.Connection.commit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">commit()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="k_ctds.Connection.bulk_insert">
<span class="sig-name descname"><span class="pre">bulk_insert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tablock</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auto_encode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_ctds.Connection.bulk_insert" title="Link to this definition"></a></dt>
<dd><p>Bulk insert rows into a given table.
This method utilizes the <cite>BULK INSERT</cite> functionality of SQL Server
to efficiently insert large amounts of data into a table. By default,
rows are not validated until all rows have been processed.</p>
<p>An optional batch size may be specified to validate the inserted rows
after <cite>batch_size</cite> rows have been copied to server.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – The table in which to insert the rows.</p></li>
<li><p><strong>rows</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#typeiter" title="(in Python v3.14)"><span class="xref std std-ref">typeiter</span></a>) – An iterable of data rows. Data rows are Python <cite>sequence</cite>
objects. Each item in the data row is inserted into the table in
sequential order.
Version 1.9 supports passing rows as <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>. Keys must map
to column names and must exist for all non-NULL columns.</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – An optional batch size.</p></li>
<li><p><strong>tablock</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Should the <cite>TABLOCK</cite> hint be passed?</p></li>
<li><p><strong>auto_encode</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Should Python <cite>str</cite> values be automatically
encoded based on the target column’s collation? When True,
column metadata is queried from INFORMATION_SCHEMA.COLUMNS before
the insert begins. str values destined for NVARCHAR/NCHAR/NTEXT
columns are encoded to UTF-16LE. str values destined for
VARCHAR/CHAR/TEXT columns are encoded to the column’s collation
code page. .. versionadded:: 2.0.0</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The number of rows saved to the table.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="k_ctds.Connection.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#k_ctds.Connection.close" title="Link to this definition"></a></dt>
<dd><p>Close the connection now. Pending transactions will be rolled back.
Subsequent calls to this object or any <a class="reference internal" href="cursor.html#k_ctds.Cursor" title="k_ctds.Cursor"><code class="xref py py-class docutils literal notranslate"><span class="pre">k_ctds.Cursor</span></code></a> objects it
created will raise <a class="reference internal" href="ctds.html#k_ctds.InterfaceError" title="k_ctds.InterfaceError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">k_ctds.InterfaceError</span></code></a>.</p>
<p><span class="target" id="index-1"></span><a class="pep reference external" href="https://peps.python.org/pep-0249/#Connection.close"><strong>PEP 0249#Connection.close</strong></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="k_ctds.Connection.commit">
<span class="sig-name descname"><span class="pre">commit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#k_ctds.Connection.commit" title="Link to this definition"></a></dt>
<dd><p>Commit any pending transaction to the database.</p>
<p><span class="target" id="index-2"></span><a class="pep reference external" href="https://peps.python.org/pep-0249/#commit"><strong>PEP 0249#commit</strong></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="k_ctds.Connection.cursor">
<span class="sig-name descname"><span class="pre">cursor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#k_ctds.Connection.cursor" title="Link to this definition"></a></dt>
<dd><p>Return a new <a class="reference internal" href="cursor.html#k_ctds.Cursor" title="k_ctds.Cursor"><code class="xref py py-class docutils literal notranslate"><span class="pre">k_ctds.Cursor</span></code></a> object using the connection.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="cursor.html#k_ctds.Cursor.close" title="k_ctds.Cursor.close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">k_ctds.Cursor.close()</span></code></a> should be called when the returned
cursor is no longer required.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Only one <a class="reference internal" href="cursor.html#k_ctds.Cursor" title="k_ctds.Cursor"><code class="xref py py-class docutils literal notranslate"><span class="pre">k_ctds.Cursor</span></code></a> object should be used per
connection. The last command executed on any cursor associated
with a connection will overwrite any previous results from all
other cursors.</p>
</div>
<p><span class="target" id="index-3"></span><a class="pep reference external" href="https://peps.python.org/pep-0249/#cursor"><strong>PEP 0249#cursor</strong></a></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A new Cursor object.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="cursor.html#k_ctds.Cursor" title="k_ctds.Cursor">k_ctds.Cursor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="k_ctds.Connection.database">
<span class="sig-name descname"><span class="pre">database</span></span><a class="headerlink" href="#k_ctds.Connection.database" title="Link to this definition"></a></dt>
<dd><p>The current database or <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a> if the connection is closed.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="k_ctds.Connection.messages">
<span class="sig-name descname"><span class="pre">messages</span></span><a class="headerlink" href="#k_ctds.Connection.messages" title="Link to this definition"></a></dt>
<dd><p>A list of any informational messages received from the last
<a class="reference internal" href="cursor.html#k_ctds.Cursor.execute" title="k_ctds.Cursor.execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">k_ctds.Cursor.execute()</span></code></a>, <a class="reference internal" href="cursor.html#k_ctds.Cursor.executemany" title="k_ctds.Cursor.executemany"><code class="xref py py-meth docutils literal notranslate"><span class="pre">k_ctds.Cursor.executemany()</span></code></a>, or
<a class="reference internal" href="cursor.html#k_ctds.Cursor.callproc" title="k_ctds.Cursor.callproc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">k_ctds.Cursor.callproc()</span></code></a> call.
For example, this will include messages produced by the T-SQL <cite>PRINT</cite>
and <cite>RAISERROR</cite> statements. Messages are preserved until the next call
to any of the above methods. <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a> is returned if the
connection is closed.</p>
<p><span class="target" id="index-4"></span><a class="pep reference external" href="https://peps.python.org/pep-0249/#connection-messages"><strong>PEP 0249#connection-messages</strong></a></p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.4.</span></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)">list</a>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="k_ctds.Connection.rollback">
<span class="sig-name descname"><span class="pre">rollback</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#k_ctds.Connection.rollback" title="Link to this definition"></a></dt>
<dd><p>Rollback any pending transaction to the database.</p>
<p><span class="target" id="index-5"></span><a class="pep reference external" href="https://peps.python.org/pep-0249/#rollback"><strong>PEP 0249#rollback</strong></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="k_ctds.Connection.spid">
<span class="sig-name descname"><span class="pre">spid</span></span><a class="headerlink" href="#k_ctds.Connection.spid" title="Link to this definition"></a></dt>
<dd><p>The SQL Server Session Process ID (SPID) for the connection or
<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a> if the connection is closed.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="k_ctds.Connection.tds_version">
<span class="sig-name descname"><span class="pre">tds_version</span></span><a class="headerlink" href="#k_ctds.Connection.tds_version" title="Link to this definition"></a></dt>
<dd><p>The TDS version in use for the connection or <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a> if the
connection is closed.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="k_ctds.Connection.timeout">
<span class="sig-name descname"><span class="pre">timeout</span></span><a class="headerlink" href="#k_ctds.Connection.timeout" title="Link to this definition"></a></dt>
<dd><p>The connection timeout, in seconds, or <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a> if the connection
is closed.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Setting the timeout requires FreeTDS version 1.00 or later.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="ctds.html#k_ctds.NotSupportedError" title="k_ctds.NotSupportedError"><strong>k_ctds.NotSupportedError</strong></a> – <cite>cTDS</cite> was compiled against a version of
FreeTDS which does not support setting the timeout on a connection.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="k_ctds.Connection.use">
<span class="sig-name descname"><span class="pre">use</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">database</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_ctds.Connection.use" title="Link to this definition"></a></dt>
<dd><p>Set the current database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>database</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – The database.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<section id="string-representation">
<h2>String Representation<a class="headerlink" href="#string-representation" title="Link to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">repr(connection)</span></code> returns a human-readable summary useful for
debugging:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span> <span class="o">=</span> <span class="n">k_ctds</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sa&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;secret&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">repr</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span>
<span class="go">&quot;&lt;k_ctds.Connection database=&#39;master&#39; spid=54&gt;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">repr</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span>
<span class="go">&#39;&lt;k_ctds.Connection (closed)&gt;&#39;</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.1.0.</span></p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="api.html" class="btn btn-neutral float-left" title="API Reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cursor.html" class="btn btn-neutral float-right" title="Cursor" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026-, Kodda Labs, Inc..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>