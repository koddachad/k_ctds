        -:    0:Source:src/k_ctds/tds.c
        -:    0:Source is newer than graph
        -:    1:#include "include/push_warnings.h"
        -:    2:#include <Python.h>
        -:    3:#include <sybdb.h>
        -:    4:#include <ctpublic.h>
        -:    5:#include "include/pop_warnings.h"
        -:    6:
        -:    7:#include "include/c99int.h"
        -:    8:#include "include/connection.h"
        -:    9:#include "include/cursor.h"
        -:   10:#include "include/macros.h"
        -:   11:#include "include/parameter.h"
        -:   12:#include "include/pyutils.h"
        -:   13:#include "include/tds.h"
        -:   14:#include "include/type.h"
        -:   15:
        -:   16:#ifdef __GNUC__
        -:   17:/*
        -:   18:    Ignore "string length ‘1189’ is greater than the length ‘509’ ISO C90
        -:   19:    compilers are required to support [-Werror=overlength-strings]".
        -:   20:*/
        -:   21:#  pragma GCC diagnostic ignored "-Woverlength-strings"
        -:   22:#endif /* ifdef __GNUC__ */
        -:   23:
        -:   24:PyObject* PyExc_tds_Warning = NULL;
        -:   25:PyObject* PyExc_tds_Error = NULL;
        -:   26:PyObject* PyExc_tds_InterfaceError = NULL;
        -:   27:PyObject* PyExc_tds_DatabaseError = NULL;
        -:   28:PyObject* PyExc_tds_DataError = NULL;
        -:   29:PyObject* PyExc_tds_OperationalError = NULL;
        -:   30:PyObject* PyExc_tds_IntegrityError = NULL;
        -:   31:PyObject* PyExc_tds_InternalError = NULL;
        -:   32:PyObject* PyExc_tds_ProgrammingError = NULL;
        -:   33:PyObject* PyExc_tds_NotSupportedError = NULL;
        -:   34:
        -:   35:#ifndef CTDS_MAJOR_VERSION
        -:   36:#  define CTDS_MAJOR_VERSION 0
        -:   37:#endif
        -:   38:
        -:   39:#ifndef CTDS_MINOR_VERSION
        -:   40:#  define CTDS_MINOR_VERSION 0
        -:   41:#endif
        -:   42:
        -:   43:#ifndef CTDS_PATCH_VERSION
        -:   44:#  define CTDS_PATCH_VERSION 0
        -:   45:#endif
        -:   46:
        -:   47:/**
        -:   48:   tds module definition.
        -:   49: */
        -:   50:static const char s_tds_doc[] =
        -:   51:    "DB API 2.0-compliant Python library for TDS-based databases.\n";
        -:   52:
        -:   53:/* Default values for connect. */
        -:   54:#ifndef DEFAULT_PORT
        -:   55:#  define DEFAULT_PORT 1433
        -:   56:#endif
        -:   57:#ifndef DEFAULT_USERNAME
        -:   58:#  define DEFAULT_USERNAME ""
        -:   59:#endif
        -:   60:#ifndef DEFAULT_PASSWORD
        -:   61:#  define DEFAULT_PASSWORD ""
        -:   62:#endif
        -:   63:#ifndef DEFAULT_APPNAME
        -:   64:#  define DEFAULT_APPNAME "k_ctds"
        -:   65:#endif
        -:   66:#ifndef DEFAULT_LOGIN_TIMEOUT
        -:   67:#  define DEFAULT_LOGIN_TIMEOUT 5
        -:   68:#endif
        -:   69:#ifndef DEFAULT_TIMEOUT
        -:   70:#  define DEFAULT_TIMEOUT 5
        -:   71:#endif
        -:   72:#ifndef DEFAULT_AUTOCOMMIT
        -:   73:#  define DEFAULT_AUTOCOMMIT 0
        -:   74:#endif
        -:   75:#ifndef DEFAULT_ANSI_DEFAULTS
        -:   76:#  define DEFAULT_ANSI_DEFAULTS 1
        -:   77:#endif
        -:   78:#ifndef DEFAULT_ENABLE_BCP
        -:   79:#  define DEFAULT_ENABLE_BCP 1
        -:   80:#endif
        -:   81:#ifndef DEFAULT_READ_ONLY
        -:   82:#  define DEFAULT_READ_ONLY 0
        -:   83:#endif
        -:   84:#ifndef DEFAULT_NTLMV2
        -:   85:#  define DEFAULT_NTLMV2 0
        -:   86:#endif
        -:   87:
        -:   88:#if DEFAULT_AUTOCOMMIT
        -:   89:#  define DEFAULT_AUTOCOMMIT_STR "True"
        -:   90:#else
        -:   91:#  define DEFAULT_AUTOCOMMIT_STR "False"
        -:   92:#endif
        -:   93:
        -:   94:#if DEFAULT_ANSI_DEFAULTS
        -:   95:#  define DEFAULT_ANSI_DEFAULTS_STR "True"
        -:   96:#else
        -:   97:#  define DEFAULT_ANSI_DEFAULTS_STR "False"
        -:   98:#endif
        -:   99:
        -:  100:#if DEFAULT_ENABLE_BCP
        -:  101:#  define DEFAULT_ENABLE_BCP_STR "True"
        -:  102:#else
        -:  103:#  define DEFAULT_ENABLE_BCP_STR "False"
        -:  104:#endif
        -:  105:
        -:  106:#if DEFAULT_READ_ONLY
        -:  107:#  define DEFAULT_READ_ONLY_STR "True"
        -:  108:#else
        -:  109:#  define DEFAULT_READ_ONLY_STR "False"
        -:  110:#endif
        -:  111:
        -:  112:#if DEFAULT_NTLMV2
        -:  113:#  define DEFAULT_NTLMV2_STR "True"
        -:  114:#else
        -:  115:#  define DEFAULT_NTLMV2_STR "False"
        -:  116:#endif
        -:  117:
        -:  118:#define CTDS_DEFAULT_PARAMSTYLE "numeric"
        -:  119:
        -:  120:
        -:  121:static const char s_tds_connect_doc[] =
        -:  122:    "connect(server, "
        -:  123:            "port=" STRINGIFY(DEFAULT_PORT) ", "
        -:  124:            "instance=None, "
        -:  125:            "user='" DEFAULT_USERNAME "', "
        -:  126:            "password='" DEFAULT_PASSWORD "', "
        -:  127:            "database=None, "
        -:  128:            "appname='" DEFAULT_APPNAME "', "
        -:  129:            "hostname=None, "
        -:  130:            "login_timeout=" STRINGIFY(DEFAULT_LOGIN_TIMEOUT) ", "
        -:  131:            "timeout=" STRINGIFY(DEFAULT_LOGIN_TIMEOUT) ", "
        -:  132:            "tds_version=None, "
        -:  133:            "autocommit=" DEFAULT_AUTOCOMMIT_STR ", "
        -:  134:            "ansi_defaults=" DEFAULT_ANSI_DEFAULTS_STR ", "
        -:  135:            "enable_bcp=" DEFAULT_ENABLE_BCP_STR ", "
        -:  136:            "paramstyle=None, "
        -:  137:            "read_only=" DEFAULT_READ_ONLY_STR ", "
        -:  138:            "ntlmv2=" DEFAULT_NTLMV2_STR ")\n"
        -:  139:    "\n"
        -:  140:    "Connect to a database.\n"
        -:  141:    "\n"
        -:  142:    ".. note::\n"
        -:  143:    "\n"
        -:  144:    "    :py:meth:`k_ctds.Connection.close` should be called when the returned\n"
        -:  145:    "    connection object is no longer required.\n"
        -:  146:    "\n"
        -:  147:    ":pep:`0249#connect`\n"
        -:  148:    "\n"
        -:  149:    ".. versionadded:: 1.6\n"
        -:  150:    "    `paramstyle`\n"
        -:  151:    "\n"
        -:  152:    ".. versionadded:: 1.6\n"
        -:  153:    "    `read_only`\n"
        -:  154:    "\n"
        -:  155:    ".. versionadded:: 1.8\n"
        -:  156:    "    `hostname`\n"
        -:  157:    "\n"
        -:  158:    ".. versionadded:: 1.8\n"
        -:  159:    "    `ntlmv2`\n"
        -:  160:    "\n"
        -:  161:    ":param str server: The database server host.\n"
        -:  162:
        -:  163:    ":param int port: The database server port. This value is ignored if\n"
        -:  164:    "    `instance` is provided.\n"
        -:  165:
        -:  166:    ":param str instance: An optional database instance to connect to.\n"
        -:  167:
        -:  168:    ":param str user: The database server username.\n"
        -:  169:
        -:  170:    ":param str password: The database server password.\n"
        -:  171:
        -:  172:    ":param str database: An optional database to initially connect to.\n"
        -:  173:
        -:  174:    ":param str appname: An optional application name to associate with\n"
        -:  175:    "    the connection.\n"
        -:  176:
        -:  177:    ":param str hostname: An optional client host name to associate with\n"
        -:  178:    "    the connection instead of the local device hostname.\n"
        -:  179:
        -:  180:    ":param int login_timeout: An optional login timeout, in seconds.\n"
        -:  181:
        -:  182:    ":param int timeout: An optional timeout for database requests, in\n"
        -:  183:    "    seconds.\n"
        -:  184:
        -:  185:    ":param str tds_version: The TDS protocol version to use. If\n"
        -:  186:    "    :py:data:`None` is specified, the highest version supported by\n"
        -:  187:    "    FreeTDS will be used.\n"
        -:  188:
        -:  189:    ":param bool autocommit: Autocommit transactions on the connection.\n"
        -:  190:
        -:  191:    ":param bool ansi_defaults: Set `ANSI_DEFAULTS` and related settings to\n"
        -:  192:    "    mimic ODBC drivers.\n"
        -:  193:
        -:  194:    ":param bool enable_bcp: Enable bulk copy support on the connection. This\n"
        -:  195:    "    is required for :py:meth:`.bulk_insert` to function.\n"
        -:  196:
        -:  197:    ":param str paramstyle: Override the default :py:data:`k_ctds.paramstyle` value for\n"
        -:  198:    "    this connection. Supported values: `numeric`, `named`.\n"
        -:  199:
        -:  200:    ":param bool read_only: Indicate 'read-only' application intent.\n"
        -:  201:
        -:  202:    ":param bool ntlmv2: Enable NTLMv2 authentication.\n"
        -:  203:
        -:  204:    ":return: A new `Connection` object connected to the database.\n"
        -:  205:    ":rtype: Connection\n";
        -:  206:
        -:  207:/**
        -:  208:   https://www.python.org/dev/peps/pep-0249/#connect
        -:  209:*/
function tds_connect called 0 returned 0% blocks executed 0%
    #####:  210:static PyObject* tds_connect(PyObject* self, PyObject* args, PyObject* kwargs)
        -:  211:{
    #####:  212:    static char* s_kwlist[] =
        -:  213:    {
        -:  214:        "server",
        -:  215:        "port",
        -:  216:        "instance",
        -:  217:        "user",
        -:  218:        "password",
        -:  219:        "database",
        -:  220:        "appname",
        -:  221:        "hostname",
        -:  222:        "login_timeout",
        -:  223:        "timeout",
        -:  224:        "tds_version",
        -:  225:        "autocommit",
        -:  226:        "ansi_defaults",
        -:  227:        "enable_bcp",
        -:  228:        "paramstyle",
        -:  229:        "read_only",
        -:  230:        "ntlmv2",
        -:  231:        NULL
        -:  232:    };
        -:  233:
        -:  234:#define PARAMSTYLE(_paramstyle) { #_paramstyle, ParamStyle_ ## _paramstyle }
    #####:  235:    static const struct {
        -:  236:        const char* serialized;
        -:  237:        enum ParamStyle paramstyle;
        -:  238:    } s_paramstyles[] = {
        -:  239:        PARAMSTYLE(named),
        -:  240:        PARAMSTYLE(numeric)
        -:  241:    };
        -:  242:#undef PARAMSTYLE
    #####:  243:    size_t ix;
        -:  244:
    #####:  245:    char* server = NULL;
    #####:  246:    uint16_t port = DEFAULT_PORT;
    #####:  247:    char* instance = NULL;
    #####:  248:    char* username = DEFAULT_USERNAME;
    #####:  249:    char* password = DEFAULT_PASSWORD;
    #####:  250:    char* database = NULL;
    #####:  251:    char* appname = DEFAULT_APPNAME;
    #####:  252:    char* hostname = NULL;
    #####:  253:    unsigned int login_timeout = DEFAULT_LOGIN_TIMEOUT;
    #####:  254:    unsigned int timeout = DEFAULT_TIMEOUT;
    #####:  255:    char* tds_version = NULL;
    #####:  256:    PyObject* autocommit = (DEFAULT_AUTOCOMMIT) ? Py_True : Py_False;
    #####:  257:    PyObject* ansi_defaults = (DEFAULT_ANSI_DEFAULTS) ? Py_True : Py_False;
    #####:  258:    PyObject* enable_bcp = (DEFAULT_ENABLE_BCP) ? Py_True : Py_False;
    #####:  259:    PyObject* read_only = (DEFAULT_READ_ONLY) ? Py_True : Py_False;
    #####:  260:    PyObject* ntlmv2 = (DEFAULT_NTLMV2) ? Py_True : Py_False;
    #####:  261:    char* paramstyle_str = CTDS_DEFAULT_PARAMSTYLE;
    #####:  262:    if (!PyArg_ParseTupleAndKeywords(args, kwargs, "s|HzzzzzzIIzO!O!O!zO!O!", s_kwlist, &server,
call    0 never executed
branch  1 never executed
branch  2 never executed
        -:  263:                                     &port, &instance, &username, &password,
        -:  264:                                     &database, &appname, &hostname,
        -:  265:                                     &login_timeout, &timeout, &tds_version,
        -:  266:                                     &PyBool_Type, &autocommit,
        -:  267:                                     &PyBool_Type, &ansi_defaults,
        -:  268:                                     &PyBool_Type, &enable_bcp,
        -:  269:                                     &paramstyle_str,
        -:  270:                                     &PyBool_Type, &read_only,
        -:  271:                                     &PyBool_Type, &ntlmv2))
        -:  272:    {
        -:  273:        return NULL;
        -:  274:    }
        -:  275:
    #####:  276:    for (ix = 0; ix < ARRAYSIZE(s_paramstyles); ++ix)
branch  0 never executed
branch  1 never executed
        -:  277:    {
    #####:  278:        if (0 == strcmp(paramstyle_str, s_paramstyles[ix].serialized))
branch  0 never executed
branch  1 never executed
        -:  279:        {
    #####:  280:            return Connection_create(server, port, instance, username, password,
        -:  281:                                     database, appname, hostname,
        -:  282:                                     login_timeout, timeout,
        -:  283:                                     tds_version, (Py_True == autocommit),
        -:  284:                                     (Py_True == ansi_defaults),
        -:  285:                                     (Py_True == enable_bcp),
    #####:  286:                                     s_paramstyles[ix].paramstyle,
call    0 never executed
        -:  287:                                     (Py_True == read_only),
        -:  288:                                     (Py_True == ntlmv2));
        -:  289:        }
        -:  290:    }
        -:  291:
    #####:  292:    PyErr_Format(PyExc_tds_InterfaceError, "unsupported paramstyle \"%s\"", paramstyle_str);
        -:  293:
    #####:  294:    return NULL;
call    0 never executed
        -:  295:
    #####:  296:    UNUSED(self);
        -:  297:}
        -:  298:
        -:  299:#define VERIFY_DATETIME_PART(_part, _min, _max) \
        -:  300:    if ((_part) < (_min) || (_part) > (_max)) \
        -:  301:    { \
        -:  302:        PyErr_Format(PyExc_ValueError, STRINGIFY(_part) " is out of range"); \
        -:  303:        return NULL; \
        -:  304:    }
        -:  305:
        -:  306:/* https://www.python.org/dev/peps/pep-0249/#date */
        -:  307:static const char s_tds_Date_doc[] =
        -:  308:    "Date(year, month, day)\n"
        -:  309:    "\n"
        -:  310:    "This function constructs an object holding a date value.\n"
        -:  311:    "\n"
        -:  312:    ":pep:`0249#date`\n"
        -:  313:    "\n"
        -:  314:    ":param int year: The year.\n"
        -:  315:
        -:  316:    ":param int month: The month.\n"
        -:  317:
        -:  318:    ":param int day: The day.\n"
        -:  319:
        -:  320:    ":return: A new `date` object.\n"
        -:  321:    ":rtype: datetime.date\n";
        -:  322:
function tds_Date called 0 returned 0% blocks executed 0%
    #####:  323:static PyObject* tds_Date(PyObject* self, PyObject* args)
        -:  324:{
    #####:  325:    int year, month, day;
    #####:  326:    if (!PyArg_ParseTuple(args, "iii", &year, &month, &day))
call    0 never executed
branch  1 never executed
branch  2 never executed
        -:  327:    {
        -:  328:        return NULL;
        -:  329:    }
    #####:  330:    VERIFY_DATETIME_PART(year, 1, 9999);
branch  0 never executed
branch  1 never executed
call    2 never executed
    #####:  331:    VERIFY_DATETIME_PART(month, 1, 12);
branch  0 never executed
branch  1 never executed
call    2 never executed
    #####:  332:    VERIFY_DATETIME_PART(day, 1, 31);
branch  0 never executed
branch  1 never executed
call    2 never executed
        -:  333:
    #####:  334:    return PyDate_FromDate_(year, month, day);
call    0 never executed
    #####:  335:    UNUSED(self);
        -:  336:}
        -:  337:
        -:  338:/* https://www.python.org/dev/peps/pep-0249/#time */
        -:  339:static const char s_tds_Time_doc[] =
        -:  340:    "Time(hour, minute, second)\n"
        -:  341:    "\n"
        -:  342:    "This function constructs an object holding a time value.\n"
        -:  343:    "\n"
        -:  344:    ":pep:`0249#time`\n"
        -:  345:    "\n"
        -:  346:    ":param int hour: The hour.\n"
        -:  347:
        -:  348:    ":param int minute: The minute.\n"
        -:  349:
        -:  350:    ":param int second: The second.\n"
        -:  351:
        -:  352:    ":return: A new `time` object.\n"
        -:  353:    ":rtype: datetime.time\n";
        -:  354:
function tds_Time called 0 returned 0% blocks executed 0%
    #####:  355:static PyObject* tds_Time(PyObject* self, PyObject* args)
        -:  356:{
    #####:  357:    int hour, minute, second;
    #####:  358:    if (!PyArg_ParseTuple(args, "iii", &hour, &minute, &second))
call    0 never executed
branch  1 never executed
branch  2 never executed
        -:  359:    {
        -:  360:        return NULL;
        -:  361:    }
    #####:  362:    VERIFY_DATETIME_PART(hour, 0, 23);
branch  0 never executed
branch  1 never executed
call    2 never executed
    #####:  363:    VERIFY_DATETIME_PART(minute, 0, 59);
branch  0 never executed
branch  1 never executed
call    2 never executed
    #####:  364:    VERIFY_DATETIME_PART(second, 0, 59);
branch  0 never executed
branch  1 never executed
call    2 never executed
        -:  365:
    #####:  366:    return PyTime_FromTime_(hour, minute, second, 0);
call    0 never executed
    #####:  367:    UNUSED(self);
        -:  368:}
        -:  369:
        -:  370:/* https://www.python.org/dev/peps/pep-0249/#timestamp */
        -:  371:static const char s_tds_Timestamp_doc[] =
        -:  372:    "Timestamp(year, month, day, hour, minute, second)\n"
        -:  373:    "\n"
        -:  374:    "This function constructs an object holding a time stamp value.\n"
        -:  375:    "\n"
        -:  376:    ":pep:`0249#timestamp`\n"
        -:  377:    "\n"
        -:  378:    ":param int year: The year.\n"
        -:  379:
        -:  380:    ":param int month: The month.\n"
        -:  381:
        -:  382:    ":param int day: The day.\n"
        -:  383:
        -:  384:    ":param int hour: The hour.\n"
        -:  385:
        -:  386:    ":param int minute: The minute.\n"
        -:  387:
        -:  388:    ":param int second: The second.\n"
        -:  389:
        -:  390:    ":return: A new `datetime` object.\n"
        -:  391:    ":rtype: datetime.datetime\n";
        -:  392:
function tds_Timestamp called 0 returned 0% blocks executed 0%
    #####:  393:static PyObject* tds_Timestamp(PyObject* self, PyObject* args)
        -:  394:{
    #####:  395:    int year, month, day, hour, minute, second;
    #####:  396:    if (!PyArg_ParseTuple(args, "iiiiii", &year, &month, &day, &hour, &minute, &second))
call    0 never executed
branch  1 never executed
branch  2 never executed
        -:  397:    {
        -:  398:        return NULL;
        -:  399:    }
        -:  400:
    #####:  401:    VERIFY_DATETIME_PART(year, 1, 9999);
branch  0 never executed
branch  1 never executed
call    2 never executed
    #####:  402:    VERIFY_DATETIME_PART(month, 1, 12);
branch  0 never executed
branch  1 never executed
call    2 never executed
    #####:  403:    VERIFY_DATETIME_PART(day, 1, 31);
branch  0 never executed
branch  1 never executed
call    2 never executed
    #####:  404:    VERIFY_DATETIME_PART(hour, 0, 23);
branch  0 never executed
branch  1 never executed
call    2 never executed
    #####:  405:    VERIFY_DATETIME_PART(minute, 0, 59);
branch  0 never executed
branch  1 never executed
call    2 never executed
    #####:  406:    VERIFY_DATETIME_PART(second, 0, 59);
branch  0 never executed
branch  1 never executed
call    2 never executed
        -:  407:
    #####:  408:    return PyDateTime_FromDateAndTime_(year, month, day, hour, minute, second, 0);
call    0 never executed
    #####:  409:    UNUSED(self);
        -:  410:}
        -:  411:
        -:  412:/* https://www.python.org/dev/peps/pep-0249/#datefromticks */
        -:  413:static const char s_tds_DateFromTicks_doc[] =
        -:  414:    "DateFromTicks(ticks)\n"
        -:  415:    "\n"
        -:  416:    "This function constructs an object holding a date value from the given\n"
        -:  417:    "ticks value (number of seconds since the epoch; see the documentation of\n"
        -:  418:    "the standard Python time module for details).\n"
        -:  419:    "\n"
        -:  420:    ":pep:`0249#datefromticks`\n"
        -:  421:    "\n"
        -:  422:    ":param int ticks: The number of seconds since the epoch.\n"
        -:  423:
        -:  424:    ":return: A new date object.\n"
        -:  425:    ":rtype: datetime.date\n";
        -:  426:
function tds_DateFromTicks called 0 returned 0% blocks executed 0%
    #####:  427:static PyObject* tds_DateFromTicks(PyObject* self, PyObject* args)
        -:  428:{
    #####:  429:    return PyDate_FromTimestamp_(args);
call    0 never executed
    #####:  430:    UNUSED(self);
        -:  431:}
        -:  432:
        -:  433:/* https://www.python.org/dev/peps/pep-0249/#timefromticks */
        -:  434:static const char s_tds_TimeFromTicks_doc[] =
        -:  435:    "TimeFromTicks(ticks)\n"
        -:  436:    "\n"
        -:  437:    "This function constructs an object holding a time value from the given\n"
        -:  438:    "ticks value (number of seconds since the epoch; see the documentation of\n"
        -:  439:    "the standard Python time module for details).\n"
        -:  440:    "\n"
        -:  441:    ":pep:`0249#timefromticks`\n"
        -:  442:    "\n"
        -:  443:    ":param int ticks: The number of seconds since the epoch.\n"
        -:  444:
        -:  445:    ":return: A new `time` object.\n"
        -:  446:    ":rtype: datetime.time\n";
        -:  447:
function tds_TimeFromTicks called 0 returned 0% blocks executed 0%
    #####:  448:static PyObject* tds_TimeFromTicks(PyObject* self, PyObject* args)
        -:  449:{
    #####:  450:    PyObject* time = NULL;
    #####:  451:    PyObject* datetime = PyDateTime_FromTimestamp_(args);
call    0 never executed
    #####:  452:    if (datetime)
branch  0 never executed
branch  1 never executed
        -:  453:    {
    #####:  454:        time = PyTime_FromTime_(PyDateTime_DATE_GET_HOUR_(datetime),
call    0 never executed
call    1 never executed
call    2 never executed
call    3 never executed
call    4 never executed
        -:  455:                                PyDateTime_DATE_GET_MINUTE_(datetime),
        -:  456:                                PyDateTime_DATE_GET_SECOND_(datetime),
        -:  457:                                PyDateTime_DATE_GET_MICROSECOND_(datetime));
    #####:  458:        Py_DECREF(datetime);
branch  0 never executed
branch  1 never executed
        -:  459:    }
        -:  460:
    #####:  461:    return time;
    #####:  462:    UNUSED(self);
        -:  463:}
        -:  464:
        -:  465:/* https://www.python.org/dev/peps/pep-0249/#timestampfromticks */
        -:  466:static const char s_tds_TimestampFromTicks_doc[] =
        -:  467:    "TimestampFromTicks(ticks)\n"
        -:  468:    "\n"
        -:  469:    "This function constructs an object holding a time stamp value from the\n"
        -:  470:    "given ticks value (number of seconds since the epoch; see the\n"
        -:  471:    "documentation of the standard Python time module for details).\n"
        -:  472:    "\n"
        -:  473:    ":pep:`0249#timestampfromticks`\n"
        -:  474:    "\n"
        -:  475:    ":param int ticks: The number of seconds since the epoch.\n"
        -:  476:
        -:  477:    ":return: A new `datetime` object.\n"
        -:  478:    ":rtype: datetime.datetime\n";
        -:  479:
function tds_TimestampFromTicks called 0 returned 0% blocks executed 0%
    #####:  480:static PyObject* tds_TimestampFromTicks(PyObject* self, PyObject* args)
        -:  481:{
    #####:  482:    return PyDateTime_FromTimestamp_(args);
call    0 never executed
    #####:  483:    UNUSED(self);
        -:  484:}
        -:  485:
        -:  486:/* https://www.python.org/dev/peps/pep-0249/#binary */
        -:  487:static const char s_tds_Binary_doc[] =
        -:  488:    "Binary(string)\n"
        -:  489:    "\n"
        -:  490:    "This function constructs an object capable of holding a binary (long)\n"
        -:  491:    "string value.\n"
        -:  492:    "\n"
        -:  493:    ":pep:`0249#binary`\n"
        -:  494:    "\n"
        -:  495:    ":param str string: The string value to convert to binary.\n"
        -:  496:
        -:  497:    ":return: A new binary object.\n"
        -:  498:    ":rtype: SqlBinary";
        -:  499:
function tds_Binary called 0 returned 0% blocks executed 0%
    #####:  500:static PyObject* tds_Binary(PyObject* self, PyObject* args)
        -:  501:{
    #####:  502:    return SqlBinary_create(self, args, NULL);
call    0 never executed
        -:  503:}
        -:  504:
        -:  505:#if defined(__GNUC__) && (__GNUC__ > 7)
        -:  506:#  pragma GCC diagnostic push
        -:  507:#  pragma GCC diagnostic ignored "-Wcast-function-type"
        -:  508:#endif /* if defined(__GNUC__) && (__GNUC__ > 7) */
        -:  509:
        -:  510:static PyMethodDef s_tds_methods[] = {
        -:  511:    { "connect",            (PyCFunction)tds_connect, METH_VARARGS | METH_KEYWORDS, s_tds_connect_doc },
        -:  512:    { "Date",               tds_Date,                 METH_VARARGS,                 s_tds_Date_doc },
        -:  513:    { "Time",               tds_Time,                 METH_VARARGS,                 s_tds_Time_doc },
        -:  514:    { "Timestamp",          tds_Timestamp,            METH_VARARGS,                 s_tds_Timestamp_doc },
        -:  515:    { "DateFromTicks",      tds_DateFromTicks,        METH_VARARGS,                 s_tds_DateFromTicks_doc },
        -:  516:    { "TimeFromTicks",      tds_TimeFromTicks,        METH_VARARGS,                 s_tds_TimeFromTicks_doc },
        -:  517:    { "TimestampFromTicks", tds_TimestampFromTicks,   METH_VARARGS,                 s_tds_TimestampFromTicks_doc },
        -:  518:    { "Binary",             tds_Binary,               METH_VARARGS,                 s_tds_Binary_doc },
        -:  519:    { NULL,                 NULL,                     0,                            NULL }
        -:  520:};
        -:  521:
        -:  522:#if defined(__GNUC__) && (__GNUC__ > 7)
        -:  523:#  pragma GCC diagnostic pop
        -:  524:#endif
        -:  525:
        -:  526:static PyObject* version_info = NULL;
        -:  527:
        -:  528:#if PY_MAJOR_VERSION >= 3
function tds_free called 0 returned 0% blocks executed 0%
    #####:  529:static void tds_free(void* ctx)
        -:  530:{
    #####:  531:    dbexit();
call    0 never executed
    #####:  532:    PyDateTimeType_free();
call    0 never executed
    #####:  533:    PyDecimalType_free();
call    0 never executed
    #####:  534:    PyUuidType_free();
call    0 never executed
        -:  535:
    #####:  536:    Py_XDECREF(PyExc_tds_Warning);
call    0 never executed
    #####:  537:    Py_XDECREF(PyExc_tds_Error);
call    0 never executed
    #####:  538:    Py_XDECREF(PyExc_tds_InterfaceError);
call    0 never executed
    #####:  539:    Py_XDECREF(PyExc_tds_DatabaseError);
call    0 never executed
    #####:  540:    Py_XDECREF(PyExc_tds_DataError);
call    0 never executed
    #####:  541:    Py_XDECREF(PyExc_tds_OperationalError);
call    0 never executed
    #####:  542:    Py_XDECREF(PyExc_tds_IntegrityError);
call    0 never executed
    #####:  543:    Py_XDECREF(PyExc_tds_InternalError);
call    0 never executed
    #####:  544:    Py_XDECREF(PyExc_tds_ProgrammingError);
call    0 never executed
    #####:  545:    Py_XDECREF(PyExc_tds_NotSupportedError);
call    0 never executed
    #####:  546:    Py_XDECREF(version_info);
call    0 never executed
    #####:  547:    UNUSED(ctx);
    #####:  548:}
        -:  549:#endif /* if PY_MAJOR_VERSION >= 3 */
        -:  550:
        -:  551:#if PY_MAJOR_VERSION >= 3
        -:  552:#  define PyErr_NewExceptionWithDoc_ PyErr_NewExceptionWithDoc
        -:  553:#else /* if PY_MAJOR_VERSION >= 3 */
        -:  554:#  if PY_VERSION_HEX < 0x02070000
        -:  555:static PyObject* PyErr_NewExceptionWithDoc_(const char* name, const char* doc, PyObject* base, PyObject* dict)
        -:  556:{
        -:  557:    return PyErr_NewException((char*)name, base, dict);
        -:  558:    UNUSED(doc);
        -:  559:}
        -:  560:#  else
        -:  561:#    define PyErr_NewExceptionWithDoc_(_name, _doc, _base, _dict) \
        -:  562:         PyErr_NewExceptionWithDoc((char*)(_name), (char*)_doc, (_base), (_dict))
        -:  563:#  endif /* if PY_VERSION_HEX < 0x02070000 */
        -:  564:#endif /* else if PY_MAJOR_VERSION >= 3 */
        -:  565:
        -:  566:
        -:  567:/**
        -:  568:   https://www.python.org/dev/peps/pep-0249/#warning
        -:  569:*/
        -:  570:static const char s_tds_Warning_doc[] =
        -:  571:    "Warning\n"
        -:  572:    "\n"
        -:  573:    ":pep:`0249#warning`\n"
        -:  574:    "\n"
        -:  575:    "Exception raised for important warnings like data truncations while\n"
        -:  576:    "inserting, etc.\n";
        -:  577:
        -:  578:/**
        -:  579:   https://www.python.org/dev/peps/pep-0249/#error
        -:  580:*/
        -:  581:static const char s_tds_Error_doc[] =
        -:  582:    "Error\n"
        -:  583:    "\n"
        -:  584:    ":pep:`0249#error`\n"
        -:  585:    "\n"
        -:  586:    "Exception that is the base class of all other error exceptions. You\n"
        -:  587:    "can use this to catch all errors with one single except statement.\n";
        -:  588:
        -:  589:/**
        -:  590:   https://www.python.org/dev/peps/pep-0249/#interfaceerror
        -:  591:*/
        -:  592:static const char s_tds_InterfaceError_doc[] =
        -:  593:    "InterfaceError\n"
        -:  594:    "\n"
        -:  595:    ":pep:`0249#interfaceerror`\n"
        -:  596:    "\n"
        -:  597:    "Exception raised for errors that are related to the database interface\n"
        -:  598:    "rather than the database itself.\n";
        -:  599:
        -:  600:/**
        -:  601:   https://www.python.org/dev/peps/pep-0249/#databaseerror
        -:  602:*/
        -:  603:static const char s_tds_DatabaseError_doc[] =
        -:  604:    "DatabaseError\n"
        -:  605:    "\n"
        -:  606:    ":pep:`0249#databaseerror`\n"
        -:  607:    "\n"
        -:  608:    "Exception raised for errors that are related to the database.\n"
        -:  609:    "\n"
        -:  610:    "The exception contains the following properties:\n"
        -:  611:    "\n"
        -:  612:    ".. py:attribute:: db_error\n"
        -:  613:    "\n"
        -:  614:    "    A :py:class:`dict` containing information relating to an\n"
        -:  615:    "    error returned by the database.\n"
        -:  616:    "\n"
        -:  617:    "    .. code-block:: python\n"
        -:  618:    "\n"
        -:  619:    "        {\n"
        -:  620:    "            'number': 123,\n"
        -:  621:    "            'description': 'An error description'\n"
        -:  622:    "        }\n"
        -:  623:    "\n"
        -:  624:    ".. py:attribute:: os_error\n"
        -:  625:    "\n"
        -:  626:    "    A :py:class:`dict` containing information relating to an\n"
        -:  627:    "    error caused by a database connection issue.\n"
        -:  628:    "    This will be :py:data:`None` if the error was not caused by a\n"
        -:  629:    "    connection issue.\n"
        -:  630:    "\n"
        -:  631:    "    .. code-block:: python\n"
        -:  632:    "\n"
        -:  633:    "        {\n"
        -:  634:    "            'number': 123,\n"
        -:  635:    "            'description': 'An error description'\n"
        -:  636:    "        }\n"
        -:  637:    "\n"
        -:  638:    ".. py:attribute:: last_message\n"
        -:  639:    "\n"
        -:  640:    "    A :py:class:`dict` containing more detailed information about.\n"
        -:  641:    "    the error returned from the database.\n"
        -:  642:    "    This may be :py:data:`None` if the error does not include more\n"
        -:  643:    "    information from the database, e.g. a connection error.\n"
        -:  644:    "\n"
        -:  645:    "    .. code-block:: python\n"
        -:  646:    "\n"
        -:  647:    "        {\n"
        -:  648:    "            'number': 123,\n"
        -:  649:    "            'state': 0,\n"
        -:  650:    "            'severity': 16,\n"
        -:  651:    "            'description': 'An error description'\n"
        -:  652:    "            'server': 'database-hostname'\n"
        -:  653:    "            'proc': 'procedure_name'\n"
        -:  654:    "            'line': 34\n"
        -:  655:    "        }\n";
        -:  656:
        -:  657:
        -:  658:/**
        -:  659:   https://www.python.org/dev/peps/pep-0249/#dataerror
        -:  660:*/
        -:  661:static const char s_tds_DataError_doc[] =
        -:  662:    "DataError\n"
        -:  663:    "\n"
        -:  664:    ":pep:`0249#dataerror`\n"
        -:  665:    "\n"
        -:  666:    "Exception raised for errors that are due to problems with the\n"
        -:  667:    "processed data like division by zero, numeric value out of range,\n"
        -:  668:    "etc.\n";
        -:  669:
        -:  670:/**
        -:  671:   https://www.python.org/dev/peps/pep-0249/#operationalerror
        -:  672:*/
        -:  673:static const char s_tds_OperationalError_doc[] =
        -:  674:    "OperationalError\n"
        -:  675:    "\n"
        -:  676:    ":pep:`0249#operationalerror`\n"
        -:  677:    "\n"
        -:  678:    "Exception raised for errors that are related to the database's\n"
        -:  679:    "operation and not necessarily under the control of the programmer,\n"
        -:  680:    "e.g. an unexpected disconnect occurs, the data source name is not\n"
        -:  681:    "found, a transaction could not be processed, a memory allocation\n"
        -:  682:    "error occurred during processing, etc.\n";
        -:  683:
        -:  684:/**
        -:  685:   https://www.python.org/dev/peps/pep-0249/#integrityerror
        -:  686:*/
        -:  687:static const char s_tds_IntegrityError_doc[] =
        -:  688:    "IntegrityError\n"
        -:  689:    "\n"
        -:  690:    ":pep:`0249#integrityerror`\n"
        -:  691:    "\n"
        -:  692:    "Exception raised when the relational integrity of the database is\n"
        -:  693:    "affected, e.g. a foreign key check fails.\n";
        -:  694:
        -:  695:/**
        -:  696:   https://www.python.org/dev/peps/pep-0249/#programmingerror
        -:  697:*/
        -:  698:static const char s_tds_ProgrammingError_doc[] =
        -:  699:    "ProgrammingError\n"
        -:  700:    "\n"
        -:  701:    ":pep:`0249#programmingerror`\n"
        -:  702:    "\n"
        -:  703:    "Exception raised for programming errors, e.g. table not found or\n"
        -:  704:    "already exists, syntax error in the SQL statement, wrong number of\n"
        -:  705:    "parameters specified, etc.\n";
        -:  706:
        -:  707:/**
        -:  708:   https://www.python.org/dev/peps/pep-0249/#internalerror
        -:  709:*/
        -:  710:static const char s_tds_InternalError_doc[] =
        -:  711:    "InternalError\n"
        -:  712:    "\n"
        -:  713:    ":pep:`0249#internalerror`\n"
        -:  714:    "\n"
        -:  715:    "Exception raised when the database encounters an internal error,\n"
        -:  716:    "e.g. the cursor is not valid anymore, the transaction is out of\n"
        -:  717:    "sync, etc.\n";
        -:  718:
        -:  719:/**
        -:  720:   https://www.python.org/dev/peps/pep-0249/#notsupportederror
        -:  721:*/
        -:  722:static const char s_tds_NotSupportedError_doc[] =
        -:  723:    "NotSupportedError\n"
        -:  724:    "\n"
        -:  725:    ":pep:`0249#notsupportederror`\n"
        -:  726:    "\n"
        -:  727:    "Exception raised in case a method or database API was used which is\n"
        -:  728:    "not supported by the database, e.g. calling\n"
        -:  729:    ":py:func:`~k_ctds.Connection.rollback()` on a connection that does not\n"
        -:  730:    "support transactions or has transactions turned off.\n";
        -:  731:
        -:  732:
        -:  733:#if PY_MAJOR_VERSION < 3
        -:  734:PyMODINIT_FUNC init_tds(void)
        -:  735:{
        -:  736:#  define FAIL_MODULE_INIT do { Py_XDECREF(module); return; } while (0)
        -:  737:#else /* if PY_MAJOR_VERSION < 3 */
function PyInit__tds called 0 returned 0% blocks executed 0%
    #####:  738:PyMODINIT_FUNC PyInit__tds(void)
        -:  739:{
        -:  740:#  define FAIL_MODULE_INIT do { Py_XDECREF(module); return NULL; } while (0)
        -:  741:#endif /* else if PY_MAJOR_VERSION < 3 */
        -:  742:
    #####:  743:    char freetds_version[100];
    #####:  744:    int written;
        -:  745:
        -:  746:    /* Create module object. */
        -:  747:#if PY_MAJOR_VERSION < 3
        -:  748:    PyObject* module = Py_InitModule3("_tds", s_tds_methods, s_tds_doc);
        -:  749:    Py_XINCREF(module); /* Py_InitModule3 returns a borrowed reference */
        -:  750:#else /* if PY_MAJOR_VERSION < 3 */
    #####:  751:    static struct PyModuleDef moduledef =
        -:  752:    {
        -:  753:        PyModuleDef_HEAD_INIT,
        -:  754:        "_tds",        /* m_name */
        -:  755:        s_tds_doc,     /* m_doc */
        -:  756:        -1,            /* m_size */
        -:  757:        s_tds_methods, /* m_methods */
        -:  758:        NULL,          /* m_slots */
        -:  759:        NULL,          /* m_traverse */
        -:  760:        NULL,          /* m_clear */
        -:  761:        tds_free       /* m_free */
        -:  762:    };
    #####:  763:    PyObject* module = PyModule_Create(&moduledef);
call    0 never executed
        -:  764:#endif /* else if PY_MAJOR_VERSION < 3 */
        -:  765:
    #####:  766:    if (!module) FAIL_MODULE_INIT;
branch  0 never executed
branch  1 never executed
call    2 never executed
        -:  767:
        -:  768:    /***** Define module-level constants. *****/
        -:  769:
        -:  770:    /**
        -:  771:       https://www.python.org/dev/peps/pep-0249/#threadsafety
        -:  772:    */
    #####:  773:    if (0 != PyModule_AddIntConstant(module, "threadsafety", 1)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
        -:  774:
        -:  775:    /**
        -:  776:       https://www.python.org/dev/peps/pep-0249/#apilevel
        -:  777:    */
    #####:  778:    if (0 != PyModule_AddStringConstant(module, "apilevel", "2.0")) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
        -:  779:
        -:  780:    /**
        -:  781:       https://www.python.org/dev/peps/pep-0249/#pyformat
        -:  782:    */
    #####:  783:    if (0 != PyModule_AddStringConstant(module, "paramstyle", CTDS_DEFAULT_PARAMSTYLE)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
        -:  784:
    #####:  785:    if (0 != PyModule_AddIntMacro(module, TDSCHAR)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  786:    if (0 != PyModule_AddIntMacro(module, TDSVARCHAR)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  787:    if (0 != PyModule_AddIntMacro(module, TDSNCHAR)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  788:    if (0 != PyModule_AddIntMacro(module, TDSNVARCHAR)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  789:    if (0 != PyModule_AddIntMacro(module, TDSTEXT)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  790:    if (0 != PyModule_AddIntMacro(module, TDSNTEXT)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  791:    if (0 != PyModule_AddIntMacro(module, TDSBIT)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  792:    if (0 != PyModule_AddIntMacro(module, TDSBITN)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  793:    if (0 != PyModule_AddIntMacro(module, TDSINTN)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  794:    if (0 != PyModule_AddIntMacro(module, TDSTINYINT)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  795:    if (0 != PyModule_AddIntMacro(module, TDSSMALLINT)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  796:    if (0 != PyModule_AddIntMacro(module, TDSINT)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  797:    if (0 != PyModule_AddIntMacro(module, TDSBIGINT)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  798:    if (0 != PyModule_AddIntMacro(module, TDSFLOAT)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  799:    if (0 != PyModule_AddIntMacro(module, TDSFLOATN)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  800:    if (0 != PyModule_AddIntMacro(module, TDSREAL)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  801:    if (0 != PyModule_AddIntMacro(module, TDSDATETIME)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  802:    if (0 != PyModule_AddIntMacro(module, TDSSMALLDATETIME)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  803:    if (0 != PyModule_AddIntMacro(module, TDSDATETIMEN)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  804:    if (0 != PyModule_AddIntMacro(module, TDSDATE)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  805:    if (0 != PyModule_AddIntMacro(module, TDSTIME)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  806:    if (0 != PyModule_AddIntMacro(module, TDSDATETIME2)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  807:    if (0 != PyModule_AddIntMacro(module, TDSDATETIMEOFFSET)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  808:    if (0 != PyModule_AddIntMacro(module, TDSIMAGE)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  809:    if (0 != PyModule_AddIntMacro(module, TDSSMALLMONEY)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  810:    if (0 != PyModule_AddIntMacro(module, TDSMONEY)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  811:    if (0 != PyModule_AddIntMacro(module, TDSMONEYN)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  812:    if (0 != PyModule_AddIntMacro(module, TDSNUMERIC)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  813:    if (0 != PyModule_AddIntMacro(module, TDSDECIMAL)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  814:    if (0 != PyModule_AddIntMacro(module, TDSBINARY)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  815:    if (0 != PyModule_AddIntMacro(module, TDSVARBINARY)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  816:    if (0 != PyModule_AddIntMacro(module, TDSGUID)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  817:    if (0 != PyModule_AddIntMacro(module, TDSVOID)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
        -:  818:
        -:  819:    /***** Define exception types. *****/
        -:  820:
        -:  821:    #define ADD_EXCEPTION_TO_MODULE(name) \
        -:  822:        Py_INCREF(PyExc_tds_##name); /* add ref for module to steal (global variable owns existing ref) */ \
        -:  823:        PyModule_AddObject(module, #name, PyExc_tds_##name);
        -:  824:
        -:  825:#if PY_MAJOR_VERSION >= 3
        -:  826:#  define PyExc_StandardError PyExc_Exception
        -:  827:#endif
        -:  828:
    #####:  829:    if (!(PyExc_tds_Warning = PyErr_NewExceptionWithDoc_("_tds.Warning", s_tds_Warning_doc, PyExc_StandardError, NULL))) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  830:    ADD_EXCEPTION_TO_MODULE(Warning);
branch  0 never executed
branch  1 never executed
call    2 never executed
    #####:  831:    if (!(PyExc_tds_Error = PyErr_NewExceptionWithDoc_("_tds.Error", s_tds_Error_doc, PyExc_StandardError, NULL))) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  832:    ADD_EXCEPTION_TO_MODULE(Error);
branch  0 never executed
branch  1 never executed
call    2 never executed
    #####:  833:    if (!(PyExc_tds_InterfaceError = PyErr_NewExceptionWithDoc_("_tds.InterfaceError", s_tds_InterfaceError_doc, PyExc_tds_Error, NULL))) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  834:    ADD_EXCEPTION_TO_MODULE(InterfaceError);
branch  0 never executed
branch  1 never executed
call    2 never executed
    #####:  835:    if (!(PyExc_tds_DatabaseError = PyErr_NewExceptionWithDoc_("_tds.DatabaseError", s_tds_DatabaseError_doc, PyExc_tds_Error, NULL))) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  836:    ADD_EXCEPTION_TO_MODULE(DatabaseError);
branch  0 never executed
branch  1 never executed
call    2 never executed
    #####:  837:    if (!(PyExc_tds_DataError = PyErr_NewExceptionWithDoc_("_tds.DataError", s_tds_DataError_doc, PyExc_tds_DatabaseError, NULL))) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  838:    ADD_EXCEPTION_TO_MODULE(DataError);
branch  0 never executed
branch  1 never executed
call    2 never executed
    #####:  839:    if (!(PyExc_tds_OperationalError = PyErr_NewExceptionWithDoc_("_tds.OperationalError", s_tds_OperationalError_doc, PyExc_tds_DatabaseError, NULL))) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  840:    ADD_EXCEPTION_TO_MODULE(OperationalError);
branch  0 never executed
branch  1 never executed
call    2 never executed
    #####:  841:    if (!(PyExc_tds_IntegrityError = PyErr_NewExceptionWithDoc_("_tds.IntegrityError", s_tds_IntegrityError_doc, PyExc_tds_DatabaseError, NULL))) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  842:    ADD_EXCEPTION_TO_MODULE(IntegrityError);
branch  0 never executed
branch  1 never executed
call    2 never executed
    #####:  843:    if (!(PyExc_tds_InternalError = PyErr_NewExceptionWithDoc_("_tds.InternalError", s_tds_InternalError_doc, PyExc_tds_DatabaseError, NULL))) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  844:    ADD_EXCEPTION_TO_MODULE(InternalError);
branch  0 never executed
branch  1 never executed
call    2 never executed
    #####:  845:    if (!(PyExc_tds_ProgrammingError = PyErr_NewExceptionWithDoc_("_tds.ProgrammingError", s_tds_ProgrammingError_doc, PyExc_tds_DatabaseError, NULL))) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  846:    ADD_EXCEPTION_TO_MODULE(ProgrammingError);
branch  0 never executed
branch  1 never executed
call    2 never executed
    #####:  847:    if (!(PyExc_tds_NotSupportedError = PyErr_NewExceptionWithDoc_("_tds.NotSupportedError", s_tds_NotSupportedError_doc, PyExc_tds_DatabaseError, NULL))) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  848:    ADD_EXCEPTION_TO_MODULE(NotSupportedError);
branch  0 never executed
branch  1 never executed
call    2 never executed
        -:  849:
        -:  850:    /***** Define custom types. *****/
        -:  851:
    #####:  852:    if (0 != PyModule_AddObject(module, "Connection", (PyObject*)ConnectionType_init())) FAIL_MODULE_INIT;
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
    #####:  853:    if (0 != PyModule_AddObject(module, "Cursor", (PyObject*)CursorType_init())) FAIL_MODULE_INIT;
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
    #####:  854:    if (0 != PyModule_AddObject(module, "Parameter", (PyObject*)ParameterType_init())) FAIL_MODULE_INIT;
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
    #####:  855:    if (0 != PyModule_AddObject(module, "RowList", (PyObject*)RowListType_init())) FAIL_MODULE_INIT;
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
    #####:  856:    if (0 != PyModule_AddObject(module, "Row", (PyObject*)RowType_init())) FAIL_MODULE_INIT;
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
        -:  857:
    #####:  858:    if (0 != SqlTypes_init()) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
        -:  859:
        -:  860:    /* Add SQL type wrappers (in alphabetical order). */
        -:  861:#define SQL_TYPE_INIT(_type) \
        -:  862:        if (0 != PyModule_AddObject(module, "Sql" #_type, (PyObject*)Sql ## _type ## Type_init())) FAIL_MODULE_INIT
        -:  863:
        -:  864:    /* Note: types added here must be added to __init__.py */
    #####:  865:    SQL_TYPE_INIT(BigInt);
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
    #####:  866:    SQL_TYPE_INIT(Binary);
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
    #####:  867:    SQL_TYPE_INIT(Char);
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
    #####:  868:    SQL_TYPE_INIT(Date);
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
    #####:  869:    SQL_TYPE_INIT(Decimal);
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
    #####:  870:    SQL_TYPE_INIT(Int);
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
    #####:  871:    SQL_TYPE_INIT(NVarChar);
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
    #####:  872:    SQL_TYPE_INIT(SmallInt);
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
    #####:  873:    SQL_TYPE_INIT(TinyInt);
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
    #####:  874:    SQL_TYPE_INIT(VarBinary);
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
    #####:  875:    SQL_TYPE_INIT(VarChar);
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
        -:  876:
        -:  877:    /***** Import datetime module *****/
    #####:  878:    if (!PyDateTimeType_init()) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
        -:  879:
        -:  880:    /***** Import decimal type. *****/
    #####:  881:    if (!PyDecimalType_init()) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
        -:  882:
        -:  883:    /***** Import uuid type. *****/
    #####:  884:    if (!PyUuidType_init()) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
        -:  885:
        -:  886:    /***** Library version *****/
    #####:  887:    if (!(version_info = PyTuple_New(3))) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  888:    PyTuple_SET_ITEM(version_info, 0, PyLong_FromLong(CTDS_MAJOR_VERSION));
call    0 never executed
call    1 never executed
    #####:  889:    PyTuple_SET_ITEM(version_info, 1, PyLong_FromLong(CTDS_MINOR_VERSION));
call    0 never executed
call    1 never executed
    #####:  890:    PyTuple_SET_ITEM(version_info, 2, PyLong_FromLong(CTDS_PATCH_VERSION));
call    0 never executed
call    1 never executed
        -:  891:
    #####:  892:    if (0 != PyModule_AddObject(module, "version_info", version_info)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  893:    Py_INCREF(version_info);
branch  0 never executed
branch  1 never executed
        -:  894:
        -:  895:    /***** Initialize DB-lib. *****/
        -:  896:
        -:  897:    /*
        -:  898:        FreeTDS version.
        -:  899:
        -:  900:        Use the CT-library API since older versions of FreeTDS don't return
        -:  901:        a proper version string from dbversion()
        -:  902:    */
    #####:  903:    (void)ct_config(NULL, CS_GET, CS_VERSION, freetds_version, sizeof(freetds_version), &written);
call    0 never executed
    #####:  904:    if (0 != PyModule_AddStringConstant(module, "freetds_version", freetds_version)) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
        -:  905:
    #####:  906:    if (FAIL == dbinit()) FAIL_MODULE_INIT;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  907:    dberrhandle(Connection_dberrhandler);
call    0 never executed
    #####:  908:    dbmsghandle(Connection_dbmsghandler);
        -:  909:
        -:  910:#if PY_MAJOR_VERSION >= 3
    #####:  911:    return module;
call    0 never executed
        -:  912:#endif /* if PY_MAJOR_VERSION >= 3 */
        -:  913:}
