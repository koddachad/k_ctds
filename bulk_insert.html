

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bulk Insert &mdash; k-ctds 2.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=9edc463e" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=20623aea"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Connection Pooling" href="pooling.html" />
    <link rel="prev" title="Transactions" href="transactions.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            k-ctds
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="example.html">Basic Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="execute.html">Executing SQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="callproc.html">Calling Stored Procedures</a></li>
<li class="toctree-l1"><a class="reference internal" href="results.html">Reading Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="transactions.html">Transactions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Bulk Insert</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#parameters">Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example">Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inserting-from-a-csv-file">Inserting from a CSV File</a></li>
<li class="toctree-l2"><a class="reference internal" href="#batch-size">Batch Size</a></li>
<li class="toctree-l2"><a class="reference internal" href="#text-columns">Text Columns</a></li>
<li class="toctree-l2"><a class="reference internal" href="#automatic-encoding">Automatic Encoding</a></li>
<li class="toctree-l2"><a class="reference internal" href="#table-lock-hint">Table Lock Hint</a></li>
<li class="toctree-l2"><a class="reference internal" href="#handling-warnings">Handling Warnings</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pooling.html">Connection Pooling</a></li>
<li class="toctree-l1"><a class="reference internal" href="encryption.html">TLS/SSL Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="CHANGELOG.html">Change Log</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">k-ctds</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Bulk Insert</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/bulk_insert.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="bulk-insert">
<h1>Bulk Insert<a class="headerlink" href="#bulk-insert" title="Link to this heading">ÔÉÅ</a></h1>
<p><cite>cTDS</cite> supports <a class="reference external" href="https://learn.microsoft.com/en-us/sql/t-sql/statements/bulk-insert-transact-sql">BULK INSERT</a> for efficiently inserting large amounts of data
into a table using <a class="reference internal" href="connection.html#k_ctds.Connection.bulk_insert" title="k_ctds.Connection.bulk_insert"><code class="xref py py-meth docutils literal notranslate"><span class="pre">k_ctds.Connection.bulk_insert()</span></code></a>.</p>
<section id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Link to this heading">ÔÉÅ</a></h2>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">table</span></code></dt><dd><p>The name of the table to insert into.
Supports multi-part names (e.g. <code class="docutils literal notranslate"><span class="pre">dbo.MyTable</span></code>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">rows</span></code></dt><dd><p>An iterable of data rows. Each row can be a sequence
(tuple/list) or a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> mapping column names
to values (v1.9+).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">batch_size</span></code> <em>(default:</em> <code class="docutils literal notranslate"><span class="pre">None</span></code> <em>)</em></dt><dd><p>Number of rows per batch. When <code class="docutils literal notranslate"><span class="pre">None</span></code>, all rows are sent
before validation. Set this to catch errors earlier in large
imports.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">tablock</span></code> <em>(default:</em> <code class="docutils literal notranslate"><span class="pre">False</span></code> <em>)</em></dt><dd><p>When <code class="docutils literal notranslate"><span class="pre">True</span></code>, acquires a table-level lock (the SQL Server
<code class="docutils literal notranslate"><span class="pre">TABLOCK</span></code> hint) for the duration of the insert. See
<a class="reference internal" href="#table-lock-hint">Table Lock Hint</a> below.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">auto_encode</span></code> <em>(default:</em> <code class="docutils literal notranslate"><span class="pre">False</span></code> <em>)</em></dt><dd><p>When <code class="docutils literal notranslate"><span class="pre">True</span></code>, automatically encodes Python <code class="docutils literal notranslate"><span class="pre">str</span></code> values
based on each column‚Äôs type and collation. See
<a class="reference internal" href="#automatic-encoding">Automatic Encoding</a> below.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</dd>
</dl>
</section>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Link to this heading">ÔÉÅ</a></h2>
<p>A bulk insert is done by providing the name of the target table and an
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#typeiter" title="(in Python v3.14)"><span class="xref std std-ref">iterator</span></a> of rows to insert. Each row should be
a sequence containing a value for each column in the table, or a
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> mapping column names to values.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">k_ctds</span>
<span class="k">with</span> <span class="n">k_ctds</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;host&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">connection</span><span class="p">:</span>
    <span class="n">connection</span><span class="o">.</span><span class="n">bulk_insert</span><span class="p">(</span>
        <span class="s1">&#39;MyExampleTable&#39;</span><span class="p">,</span>
        <span class="c1"># A generator of the rows.</span>
        <span class="p">(</span>
            <span class="c1"># The row values can be any python sequence type</span>
            <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;hello world </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># Version 1.9 supports passing dict rows.</span>
    <span class="n">connection</span><span class="o">.</span><span class="n">bulk_insert</span><span class="p">(</span>
        <span class="s1">&#39;MyExampleTable&#39;</span><span class="p">,</span>
        <span class="c1"># A generator of the rows.</span>
        <span class="p">(</span>
            <span class="p">{</span>
                <span class="s1">&#39;IntColumn&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span>
                <span class="s1">&#39;TextColumn&#39;</span><span class="p">:</span> <span class="s1">&#39;hello world </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
</pre></div>
</div>
</section>
<section id="inserting-from-a-csv-file">
<h2>Inserting from a CSV File<a class="headerlink" href="#inserting-from-a-csv-file" title="Link to this heading">ÔÉÅ</a></h2>
<p>This example illustrates how to import data from a <em>CSV</em> file.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">k_ctds</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">csv</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;BulkInsertExample.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
    <span class="n">csvreader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">csvfile</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">k_ctds</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;host&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">connection</span><span class="p">:</span>
        <span class="n">connection</span><span class="o">.</span><span class="n">bulk_insert</span><span class="p">(</span>
            <span class="s1">&#39;BulkInsertExample&#39;</span><span class="p">,</span>
            <span class="nb">iter</span><span class="p">(</span><span class="n">csvreader</span><span class="p">)</span>
        <span class="p">)</span>

<span class="c1"># ctds 1.9 supports passing rows as dict objects, mapping column name</span>
<span class="c1"># to value. This is useful if the table contains NULLable columns</span>
<span class="c1"># not present in the CSV file.</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;BulkInsertExample.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
    <span class="n">csvreader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">csvfile</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">k_ctds</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;host&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">connection</span><span class="p">:</span>
        <span class="n">connection</span><span class="o">.</span><span class="n">bulk_insert</span><span class="p">(</span>
            <span class="s1">&#39;BulkInsertExample&#39;</span><span class="p">,</span>
            <span class="nb">iter</span><span class="p">(</span><span class="n">csvreader</span><span class="p">)</span>
        <span class="p">)</span>
</pre></div>
</div>
</section>
<section id="batch-size">
<h2>Batch Size<a class="headerlink" href="#batch-size" title="Link to this heading">ÔÉÅ</a></h2>
<p>By default, <a class="reference internal" href="connection.html#k_ctds.Connection.bulk_insert" title="k_ctds.Connection.bulk_insert"><code class="xref py py-meth docutils literal notranslate"><span class="pre">k_ctds.Connection.bulk_insert()</span></code></a> will push all data to the
database before it is actually validated against the table‚Äôs schema. If any of
the data is invalid, the entire <a class="reference external" href="https://learn.microsoft.com/en-us/sql/t-sql/statements/bulk-insert-transact-sql">BULK INSERT</a> operation would fail. The
<cite>batch_size</cite> parameter of <a class="reference internal" href="connection.html#k_ctds.Connection.bulk_insert" title="k_ctds.Connection.bulk_insert"><code class="xref py py-meth docutils literal notranslate"><span class="pre">k_ctds.Connection.bulk_insert()</span></code></a> can be used
to control how many rows should be copied before validating them.</p>
</section>
<section id="text-columns">
<h2>Text Columns<a class="headerlink" href="#text-columns" title="Link to this heading">ÔÉÅ</a></h2>
<p>Data specified for bulk insertion into text columns (e.g. <strong>VARCHAR</strong>,
<strong>NVARCHAR</strong>, <strong>TEXT</strong>) is not encoded on the client in any way by FreeTDS.
Because of this behavior it is possible to insert textual data with an invalid
encoding and cause the column data to become corrupted.</p>
<p>To prevent this, it is recommended the caller explicitly wrap the the object
with either <a class="reference internal" href="types.html#k_ctds.SqlVarChar" title="k_ctds.SqlVarChar"><code class="xref py py-class docutils literal notranslate"><span class="pre">k_ctds.SqlVarChar</span></code></a> (for <strong>CHAR</strong>, <strong>VARCHAR</strong> or <strong>TEXT</strong>
columns) or <a class="reference internal" href="types.html#k_ctds.SqlNVarChar" title="k_ctds.SqlNVarChar"><code class="xref py py-class docutils literal notranslate"><span class="pre">k_ctds.SqlNVarChar</span></code></a> (for <strong>NCHAR</strong>, <strong>NVARCHAR</strong> or
<strong>NTEXT</strong> columns). For non-Unicode columns, the value should be first encoded
to column‚Äôs encoding (e.g. <cite>latin-1</cite>). By default <a class="reference internal" href="types.html#k_ctds.SqlVarChar" title="k_ctds.SqlVarChar"><code class="xref py py-class docutils literal notranslate"><span class="pre">k_ctds.SqlVarChar</span></code></a>
will encode <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> objects to <cite>utf-8</cite>, which is likely incorrect for
most SQL Server configurations.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>As of version 2.0.0, the <code class="docutils literal notranslate"><span class="pre">auto_encode</span></code> parameter can handle
this encoding automatically. See <a class="reference internal" href="#automatic-encoding">Automatic Encoding</a> below.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">k_ctds</span>
<span class="k">with</span> <span class="n">k_ctds</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;host&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">connection</span><span class="p">:</span>
    <span class="n">connection</span><span class="o">.</span><span class="n">bulk_insert</span><span class="p">(</span>
        <span class="c1">#</span>
        <span class="c1"># Assumes a table with the following schema:</span>
        <span class="c1">#</span>
        <span class="c1"># CREATE TABLE MyExampleTableWithVarChar (</span>
        <span class="c1">#     Latin1Column VARCHAR(100) COLLATE</span>
        <span class="c1">#         SQL_Latin1_General_CP1_CI_AS,</span>
        <span class="c1">#     UnicodeColumn NVARCHAR(100)</span>
        <span class="c1"># )</span>
        <span class="c1">#</span>

        <span class="s1">&#39;MyExampleTableWithVarChar&#39;</span><span class="p">,</span>
        <span class="p">[</span>
            <span class="p">(</span>
                <span class="c1"># Note the value passed to SqlVarChar is first encoded to</span>
                <span class="c1"># match the server&#39;s encoding.</span>
                <span class="n">k_ctds</span><span class="o">.</span><span class="n">SqlVarChar</span><span class="p">(</span>
                    <span class="sa">b</span><span class="s1">&#39;a string with latin-1 -&gt; </span><span class="se">\xc2\xbd</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span>
                        <span class="s1">&#39;utf-8&#39;</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;latin-1&#39;</span><span class="p">)</span>
                <span class="p">),</span>
                <span class="c1"># SqlNVarChar handles the UTF-16LE encoding automatically</span>
                <span class="c1"># for bulk insert.</span>
                <span class="n">k_ctds</span><span class="o">.</span><span class="n">SqlNVarChar</span><span class="p">(</span>
                    <span class="sa">b</span><span class="s1">&#39;a string with Unicode -&gt; </span><span class="se">\xe3\x83\x9b</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span>
                        <span class="s1">&#39;utf-8&#39;</span>
                    <span class="p">)</span>
                <span class="p">),</span>
          <span class="p">)</span>
        <span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</section>
<section id="automatic-encoding">
<h2>Automatic Encoding<a class="headerlink" href="#automatic-encoding" title="Link to this heading">ÔÉÅ</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">auto_encode</span></code> parameter simplifies inserting text data by
automatically encoding Python <code class="docutils literal notranslate"><span class="pre">str</span></code> values based on the target
column‚Äôs type and collation. This replaces the manual wrapping
described in the <a class="reference internal" href="#text-columns">Text Columns</a> section above.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">k_ctds</span>

<span class="c1">#</span>
<span class="c1"># Assumes a table with the following schema:</span>
<span class="c1">#</span>
<span class="c1"># CREATE TABLE MyExampleTableWithVarChar (</span>
<span class="c1">#     Latin1Column VARCHAR(100) COLLATE</span>
<span class="c1">#         SQL_Latin1_General_CP1_CI_AS,</span>
<span class="c1">#     UnicodeColumn NVARCHAR(100)</span>
<span class="c1"># )</span>
<span class="c1">#</span>

<span class="n">rows</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;caf√© r√©sum√©&#39;</span><span class="p">,</span> <span class="s1">&#39;„Åì„Çì„Å´„Å°„ÅØ‰∏ñÁïå&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;na√Øve&#39;</span><span class="p">,</span> <span class="s1">&#39;üéâ Unicode works&#39;</span><span class="p">),</span>
<span class="p">]</span>

<span class="k">with</span> <span class="n">k_ctds</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;host&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">connection</span><span class="p">:</span>
    <span class="n">connection</span><span class="o">.</span><span class="n">bulk_insert</span><span class="p">(</span>
        <span class="s1">&#39;MyExampleTableWithVarChar&#39;</span><span class="p">,</span>
        <span class="n">rows</span><span class="p">,</span>
        <span class="n">auto_encode</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>With <code class="docutils literal notranslate"><span class="pre">auto_encode=True</span></code>, <code class="docutils literal notranslate"><span class="pre">'caf√©</span> <span class="pre">r√©sum√©'</span></code> is encoded to <code class="docutils literal notranslate"><span class="pre">cp1252</span></code>
bytes for the <code class="docutils literal notranslate"><span class="pre">VARCHAR</span></code> column, and <code class="docutils literal notranslate"><span class="pre">'„Åì„Çì„Å´„Å°„ÅØ‰∏ñÁïå'</span></code> is encoded to
UTF-16LE bytes for the <code class="docutils literal notranslate"><span class="pre">NVARCHAR</span></code> column ‚Äî no manual wrapping needed.</p>
<p><strong>Using dict rows with auto_encode:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">k_ctds</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;host&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">connection</span><span class="p">:</span>
    <span class="n">connection</span><span class="o">.</span><span class="n">bulk_insert</span><span class="p">(</span>
        <span class="s1">&#39;MyExampleTableWithVarChar&#39;</span><span class="p">,</span>
        <span class="p">[</span>
            <span class="p">{</span>
                <span class="s1">&#39;Latin1Column&#39;</span><span class="p">:</span> <span class="s1">&#39;caf√©&#39;</span><span class="p">,</span>
                <span class="s1">&#39;UnicodeColumn&#39;</span><span class="p">:</span> <span class="s1">&#39;hello&#39;</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s1">&#39;Latin1Column&#39;</span><span class="p">:</span> <span class="s1">&#39;na√Øve&#39;</span><span class="p">,</span>
                <span class="s1">&#39;UnicodeColumn&#39;</span><span class="p">:</span> <span class="s1">&#39;Êó•Êú¨Ë™û&#39;</span>
            <span class="p">},</span>
        <span class="p">],</span>
        <span class="n">auto_encode</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
</pre></div>
</div>
<p><strong>Combining all parameters:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">k_ctds</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;host&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">connection</span><span class="p">:</span>
    <span class="n">connection</span><span class="o">.</span><span class="n">bulk_insert</span><span class="p">(</span>
        <span class="s1">&#39;dbo.LargeImportTable&#39;</span><span class="p">,</span>
        <span class="n">row_generator</span><span class="p">(),</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span>
        <span class="n">tablock</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">auto_encode</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">auto_encode</span></code> does not support temporary tables (e.g.
<code class="docutils literal notranslate"><span class="pre">#TempTable</span></code>), because temporary tables are not visible in
<code class="docutils literal notranslate"><span class="pre">INFORMATION_SCHEMA.COLUMNS</span></code>. For temporary tables, use the
manual wrapping approach described in <a class="reference internal" href="#text-columns">Text Columns</a>.</p>
</div>
</section>
<section id="table-lock-hint">
<h2>Table Lock Hint<a class="headerlink" href="#table-lock-hint" title="Link to this heading">ÔÉÅ</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">tablock</span></code> parameter tells SQL Server to acquire a bulk-update
table-level lock for the duration of the insert. This can significantly
improve throughput when inserting large volumes of data, especially
when no other concurrent writers need the table.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">k_ctds</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;host&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">connection</span><span class="p">:</span>
    <span class="n">connection</span><span class="o">.</span><span class="n">bulk_insert</span><span class="p">(</span>
        <span class="s1">&#39;MyLargeTable&#39;</span><span class="p">,</span>
        <span class="n">large_row_generator</span><span class="p">(),</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
        <span class="n">tablock</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
</pre></div>
</div>
</section>
<section id="handling-warnings">
<h2>Handling Warnings<a class="headerlink" href="#handling-warnings" title="Link to this heading">ÔÉÅ</a></h2>
<p>Warnings raised during bulk insert (e.g. data truncation, implicit conversions)
are reported as standard Python <code class="xref py py-exc docutils literal notranslate"><span class="pre">warnings.Warning</span></code> instances. The warning
message text contains the SQL Server message description.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">k_ctds</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>

<span class="k">with</span> <span class="n">k_ctds</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;host&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">connection</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">(</span><span class="n">record</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">caught</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;always&#39;</span><span class="p">)</span>
        <span class="n">connection</span><span class="o">.</span><span class="n">bulk_insert</span><span class="p">(</span><span class="s1">&#39;MyTable&#39;</span><span class="p">,</span> <span class="n">rows</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">caught</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning: </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">message</span><span class="p">))</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Due to how SQL Server processes bulk insert data, warnings are reported
per-batch and do not identify the specific row or column that triggered
the issue. Structured message metadata (e.g. message number, severity,
state) is available via the <code class="docutils literal notranslate"><span class="pre">connection.messages</span></code> property.</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="transactions.html" class="btn btn-neutral float-left" title="Transactions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="pooling.html" class="btn btn-neutral float-right" title="Connection Pooling" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026-, Kodda Labs, Inc..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>